{"version":3,"file":"static/js/940.97eaa87d.chunk.js","mappings":"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","sources":["AddUpdateModal.tsx","ResolveIssueModal.tsx","AddItemForm.tsx","ItemDetailModal.tsx","ToolApp.tsx","ReportIssueModal.tsx","TableSettingsModal.tsx"],"sourcesContent":["import React, { useState } from 'react';\r\nimport { StockItem } from './types';\r\n\r\ninterface AddUpdateModalProps {\r\n  item: StockItem; // Pass the item for context\r\n  onSubmit: (note: string) => void;\r\n  onClose: () => void;\r\n}\r\n\r\nconst AddUpdateModal: React.FC<AddUpdateModalProps> = ({ item, onSubmit, onClose }) => {\r\n  const [note, setNote] = useState('');\r\n  const [error, setError] = useState('');\r\n\r\n  const handleSubmit = () => {\r\n    if (!note.trim()) {\r\n      setError('Please enter an update note.');\r\n      return;\r\n    }\r\n    onSubmit(note);\r\n  };\r\n\r\n  // Basic modal styling (reuse styles or define similarly)\r\n  const overlayStyle: React.CSSProperties = {\r\n    position: 'fixed', top: 0, left: 0, right: 0, bottom: 0,\r\n    backgroundColor: 'rgba(0,0,0,0.5)', display: 'flex', \r\n    alignItems: 'center', justifyContent: 'center', zIndex: 50,\r\n  };\r\n  const modalStyle: React.CSSProperties = {\r\n    backgroundColor: 'white', padding: '20px 30px', borderRadius: '8px',\r\n    border: '1px solid #ccc', maxWidth: '500px', width: '90%',\r\n    boxShadow: '0 4px 8px rgba(0,0,0,0.1)',\r\n  };\r\n  const textareaStyle: React.CSSProperties = {\r\n      width: 'calc(100% - 16px)', padding: '8px', minHeight: '80px', marginTop: '5px'\r\n  };\r\n  const errorStyle: React.CSSProperties = { color: 'red', fontSize: '0.8em', marginTop: '4px' };\r\n\r\n  return (\r\n    <div style={overlayStyle} onClick={onClose}>\r\n      <div style={modalStyle} onClick={(e) => e.stopPropagation()}>\r\n        <h3>Add Issue Update for:</h3>\r\n        <p style={{margin: '5px 0 15px 0', fontStyle: 'italic'}}>{item.productName} - {item.deliveryName}</p>\r\n        \r\n        {/* Display existing issue description for context */}\r\n        {item.issueDescription && (\r\n            <div style={{marginBottom: '15px', padding: '10px', background: '#f8f9fa', border: '1px solid #dee2e6', borderRadius: '4px'}}>\r\n                <strong>Initial Issue:</strong> {item.issueDescription}\r\n            </div>\r\n        )}\r\n\r\n        <label htmlFor=\"updateNote\" style={{ fontWeight: 'bold' }}>\r\n            Update Note:\r\n        </label>\r\n        <textarea \r\n            id=\"updateNote\"\r\n            value={note}\r\n            onChange={(e) => {\r\n                setNote(e.target.value);\r\n                if (error) setError(''); // Clear error on type\r\n            }}\r\n            style={textareaStyle}\r\n            rows={4}\r\n            placeholder=\"e.g., Contacted seller, awaiting response...\"\r\n        />\r\n        {error && <div style={errorStyle}>{error}</div>}\r\n\r\n        <div style={{ marginTop: '20px', textAlign: 'right' }}>\r\n          <button type=\"button\" onClick={onClose} style={{ marginRight: '10px', padding: '8px 15px' }}>\r\n            Cancel\r\n          </button>\r\n          <button type=\"button\" onClick={handleSubmit} style={{ padding: '8px 15px', fontWeight: 'bold' }}>\r\n            Save Update Note\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AddUpdateModal; ","import React, { useState } from 'react';\r\nimport { StockItem } from './types';\r\n\r\ninterface ResolveIssueModalProps {\r\n  item: StockItem; // Pass the item for context\r\n  onSubmit: (outcome: string, note?: string) => void;\r\n  onClose: () => void;\r\n}\r\n\r\nconst RESOLUTION_OUTCOMES = [\r\n    \"Item Accepted / Kept As Is\",\r\n    \"Item Repaired / Refurbished\",\r\n    \"Partial Refund Received\",\r\n    \"Returned to Supplier\",\r\n    \"Disposed Of\",\r\n    \"Other\" // Allows adding notes for specifics\r\n];\r\n\r\nconst ResolveIssueModal: React.FC<ResolveIssueModalProps> = ({ item, onSubmit, onClose }) => {\r\n  const [outcome, setOutcome] = useState('');\r\n  const [note, setNote] = useState('');\r\n  const [error, setError] = useState('');\r\n\r\n  const handleSubmit = () => {\r\n    if (!outcome) {\r\n      setError('Please select a resolution outcome.');\r\n      return;\r\n    }\r\n    onSubmit(outcome, note.trim() || undefined); // Pass note only if it has content\r\n  };\r\n\r\n  // Basic modal styling (reuse styles or define similarly)\r\n  const overlayStyle: React.CSSProperties = {\r\n    position: 'fixed', top: 0, left: 0, right: 0, bottom: 0,\r\n    backgroundColor: 'rgba(0,0,0,0.5)', display: 'flex', \r\n    alignItems: 'center', justifyContent: 'center', zIndex: 50,\r\n  };\r\n  const modalStyle: React.CSSProperties = {\r\n    backgroundColor: 'white', padding: '20px 30px', borderRadius: '8px',\r\n    border: '1px solid #ccc', maxWidth: '500px', width: '90%',\r\n    boxShadow: '0 4px 8px rgba(0,0,0,0.1)',\r\n  };\r\n  const inputGroupStyle: React.CSSProperties = { marginBottom: '15px' };\r\n  const labelStyle: React.CSSProperties = { display: 'block', marginBottom: '5px', fontWeight: 'bold' };\r\n  const inputStyle: React.CSSProperties = { width: 'calc(100% - 16px)', padding: '8px' }; \r\n  const errorStyle: React.CSSProperties = { color: 'red', fontSize: '0.8em', marginTop: '4px' };\r\n\r\n  return (\r\n    <div style={overlayStyle} onClick={onClose}>\r\n      <div style={modalStyle} onClick={(e) => e.stopPropagation()}>\r\n        <h3>Resolve Issue for:</h3>\r\n        <p style={{margin: '5px 0 15px 0', fontStyle: 'italic'}}>{item.productName} - {item.deliveryName}</p>\r\n        \r\n        {/* Display existing issue description for context */}\r\n        {item.issueDescription && (\r\n            <div style={{marginBottom: '15px', padding: '10px', background: '#f8f9fa', border: '1px solid #dee2e6', borderRadius: '4px'}}>\r\n                <strong>Initial Issue:</strong> {item.issueDescription}\r\n            </div>\r\n        )}\r\n\r\n        <div style={inputGroupStyle}>\r\n            <label htmlFor=\"resolutionOutcome\" style={labelStyle}>\r\n                Resolution Outcome:\r\n            </label>\r\n            <select \r\n                id=\"resolutionOutcome\"\r\n                value={outcome}\r\n                onChange={(e) => {\r\n                    setOutcome(e.target.value);\r\n                    if (error) setError(''); // Clear error on change\r\n                }}\r\n                style={inputStyle}\r\n            >\r\n                <option value=\"\" disabled>-- Select an Outcome --</option>\r\n                {RESOLUTION_OUTCOMES.map(opt => (\r\n                    <option key={opt} value={opt}>{opt}</option>\r\n                ))}\r\n            </select>\r\n             {error && <div style={errorStyle}>{error}</div>}\r\n        </div>\r\n\r\n        <div style={inputGroupStyle}>\r\n            <label htmlFor=\"resolutionNotes\" style={labelStyle}>\r\n                Resolution Notes (Optional):\r\n            </label>\r\n            <textarea \r\n                id=\"resolutionNotes\"\r\n                value={note}\r\n                onChange={(e) => setNote(e.target.value)}\r\n                style={{...inputStyle, minHeight: '60px'}}\r\n                rows={3}\r\n                placeholder=\"e.g., Supplier issued refund, repaired screen...\"\r\n            />\r\n        </div>\r\n\r\n        <div style={{ marginTop: '20px', textAlign: 'right' }}>\r\n          <button type=\"button\" onClick={onClose} style={{ marginRight: '10px', padding: '8px 15px' }}>\r\n            Cancel\r\n          </button>\r\n          <button type=\"button\" onClick={handleSubmit} style={{ padding: '8px 15px', fontWeight: 'bold' }}>\r\n            Save Resolution\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ResolveIssueModal; ","import React, { useState, useEffect } from 'react';\nimport { StockItem, PurchaseStatus, Destination } from './types';\n\n// Helper component for the info icon (basic tooltip)\nconst InfoIcon = ({ text }: { text: string }) => (\n  <span title={text} style={{ cursor: 'help', marginLeft: '4px', borderBottom: '1px dotted gray' }}>\n    ?\n  </span>\n);\n\ninterface AddItemFormProps {\n  onSave: (newItemOrUpdate: Omit<StockItem, 'id' | 'currentStatus' | 'dateDelivered' | 'processorNotes' | 'issueDescription'> & { isFlagged: boolean }) => void;\n  onClose: () => void;\n  initialData?: StockItem | null;\n  firstInputRef?: React.RefObject<HTMLInputElement | null>;\n}\n\nconst AddItemForm: React.FC<AddItemFormProps> = ({ onSave, onClose, initialData, firstInputRef }) => {\n  const isEditing = !!initialData;\n\n  // Initialize state for each form field\n  const [purchaseStatus, setPurchaseStatus] = useState<PurchaseStatus>(initialData?.purchaseStatus || 'Purchased');\n  const [deliveryName, setDeliveryName] = useState(initialData?.deliveryName || '');\n  const [productName, setProductName] = useState(initialData?.productName || '');\n  const [quantity, setQuantity] = useState<number | ''>(initialData?.quantity || '');\n  const [pricePerItem, setPricePerItem] = useState<number | ''>(initialData?.pricePerItem || '');\n  const [orderNumber, setOrderNumber] = useState(initialData?.orderNumber || '');\n  const [orderDate, setOrderDate] = useState(() => (initialData?.orderDate || new Date().toISOString().split('T')[0]));\n  const [seller, setSeller] = useState(initialData?.seller || '');\n  const [isVatRegistered, setIsVatRegistered] = useState<'Yes' | 'No' | 'Unknown'>(initialData?.isVatRegistered || 'Unknown');\n  const [destination, setDestination] = useState<Destination>(initialData?.destination || '');\n  const [asinSku, setAsinSku] = useState(initialData?.asinSku || '');\n  const [acquisitionNotes, setAcquisitionNotes] = useState(initialData?.acquisitionNotes || '');\n  const [isFlagged, setIsFlagged] = useState(initialData?.isFlagged || false);\n\n  const [errors, setErrors] = useState<Record<string, string>>({});\n\n  // Populate state if initialData changes (needed if modal reuses component instance)\n  useEffect(() => {\n    if (initialData) {\n      setPurchaseStatus(initialData.purchaseStatus || 'Purchased');\n      setDeliveryName(initialData.deliveryName || '');\n      setProductName(initialData.productName || '');\n      setQuantity(initialData.quantity || '');\n      setPricePerItem(initialData.pricePerItem || '');\n      setOrderNumber(initialData.orderNumber || '');\n      setOrderDate(initialData.orderDate || new Date().toISOString().split('T')[0]);\n      setSeller(initialData.seller || '');\n      setIsVatRegistered(initialData.isVatRegistered || 'Unknown');\n      setDestination(initialData.destination || '');\n      setAsinSku(initialData.asinSku || '');\n      setAcquisitionNotes(initialData.acquisitionNotes || '');\n      setIsFlagged(initialData.isFlagged || false);\n      setErrors({}); // Clear errors when loading new data\n    } else {\n      // Reset form if initialData becomes null (e.g., switching from edit to add)\n      // Optional: Add logic here to reset all fields if needed\n    }\n  }, [initialData]); // Re-run effect if initialData changes\n\n  const validateForm = (): boolean => {\n    const newErrors: Record<string, string> = {};\n    if (!deliveryName.trim()) newErrors.deliveryName = 'Delivery Name is required.';\n    if (!productName.trim()) newErrors.productName = 'Product Name is required.';\n    if (quantity === '' || quantity <= 0) newErrors.quantity = 'Quantity must be a positive number.';\n    if (pricePerItem === '' || pricePerItem < 0) newErrors.pricePerItem = 'Price must be zero or positive.';\n    if (!orderDate) newErrors.orderDate = 'Order Date is required.';\n\n    setErrors(newErrors);\n    return Object.keys(newErrors).length === 0;\n  };\n\n  const handleSubmit = (event: React.FormEvent) => {\n    event.preventDefault();\n    console.log('AddItemForm: handleSubmit', { deliveryName, productName, quantity, pricePerItem, orderDate, seller, destination, acquisitionNotes, isFlagged });\n    const isValid = validateForm();\n    console.log('AddItemForm: validation result', isValid, errors);\n    if (isValid) {\n      console.log('AddItemForm: form valid, calling onSave');\n      onSave({\n        purchaseStatus,\n        deliveryName,\n        productName,\n        quantity: Number(quantity),\n        pricePerItem: Number(pricePerItem),\n        orderNumber: orderNumber || undefined,\n        orderDate,\n        seller: seller || undefined,\n        isVatRegistered: isVatRegistered === 'Unknown' ? undefined : isVatRegistered,\n        destination: destination || undefined,\n        asinSku: asinSku || undefined,\n        acquisitionNotes: acquisitionNotes || undefined,\n        isFlagged: isFlagged,\n      });\n    } else {\n      console.log('AddItemForm: form invalid, errors:', errors);\n    }\n  };\n\n  // Basic form styling (can be improved later)\n  const formStyle: React.CSSProperties = {\n    backgroundColor: 'white',\n    padding: '20px',\n    border: '1px solid #ccc',\n    borderRadius: '8px',\n    maxWidth: '500px', // Limit width\n    margin: '20px auto' // Center it for now\n  };\n  const inputGroupStyle: React.CSSProperties = { marginBottom: '15px' };\n  const labelStyle: React.CSSProperties = { display: 'block', marginBottom: '5px', fontWeight: 'bold' };\n  const inputStyle: React.CSSProperties = { width: 'calc(100% - 16px)', padding: '8px' }; // Adjust width for padding\n  const errorStyle: React.CSSProperties = { color: 'red', fontSize: '0.8em', marginTop: '4px' };\n\n  return (\n    <div style={formStyle}> {/* This div acts as a basic modal container for now */}\n      <h3>{isEditing ? 'Edit Stock Item' : 'Add New Stock Item'}</h3>\n      <form onSubmit={handleSubmit}>\n\n        {/* Acquisition Details Section (Example) */}\n        <div style={inputGroupStyle}>\n          <label style={labelStyle} htmlFor=\"deliveryName\">\n            Delivery Name\n            <InfoIcon text=\"Group items arriving together with a unique name. Helps find them later. Example: eBay Batch Apr 16\" />\n          </label>\n          <input\n            ref={firstInputRef}\n            id=\"deliveryName\"\n            type=\"text\"\n            value={deliveryName}\n            onChange={(e) => setDeliveryName(e.target.value)}\n            style={inputStyle}\n          />\n          {errors.deliveryName && <div style={errorStyle}>{errors.deliveryName}</div>}\n        </div>\n\n        <div style={inputGroupStyle}>\n          <label style={labelStyle} htmlFor=\"productName\">\n            Product Name\n            <InfoIcon text=\"The common name of the item. Example: Blue Widget Model X\" />\n          </label>\n          <input\n            id=\"productName\"\n            type=\"text\"\n            value={productName}\n            onChange={(e) => setProductName(e.target.value)}\n            style={inputStyle}\n          />\n          {errors.productName && <div style={errorStyle}>{errors.productName}</div>}\n        </div>\n\n        <div style={inputGroupStyle}>\n          <label style={labelStyle} htmlFor=\"quantity\">\n            Quantity\n            <InfoIcon text=\"How many units of this item are included? Example: 50\" />\n          </label>\n          <input\n            id=\"quantity\"\n            type=\"number\"\n            value={quantity}\n            onChange={(e) => setQuantity(e.target.value === '' ? '' : Number(e.target.value))}\n            style={inputStyle}\n            min=\"1\"\n          />\n          {errors.quantity && <div style={errorStyle}>{errors.quantity}</div>}\n        </div>\n\n        <div style={inputGroupStyle}>\n          <label style={labelStyle} htmlFor=\"pricePerItem\">\n            Price Per Item\n            <InfoIcon text=\"The cost for one single unit. Example: 12.50\" />\n          </label>\n          <input\n            id=\"pricePerItem\"\n            type=\"number\"\n            value={pricePerItem}\n            onChange={(e) => setPricePerItem(e.target.value === '' ? '' : Number(e.target.value))}\n            style={inputStyle}\n            min=\"0\"\n            step=\"0.01\"\n          />\n          {errors.pricePerItem && <div style={errorStyle}>{errors.pricePerItem}</div>}\n        </div>\n\n        <div style={inputGroupStyle}>\n          <label style={labelStyle} htmlFor=\"orderDate\">\n            Order Date\n            <InfoIcon text=\"The date the item was purchased or the return initiated.\" />\n          </label>\n          <input\n            id=\"orderDate\"\n            type=\"date\"\n            value={orderDate}\n            onChange={(e) => setOrderDate(e.target.value)}\n            style={inputStyle}\n          />\n          {errors.orderDate && <div style={errorStyle}>{errors.orderDate}</div>}\n        </div>\n        \n        {/* Add other fields similarly... */}\n         <div style={inputGroupStyle}>\n          <label style={labelStyle} htmlFor=\"purchaseStatus\">\n            Purchase Status\n            <InfoIcon text=\"What is the origin of this item?\" />\n          </label>\n          <select \n            id=\"purchaseStatus\" \n            value={purchaseStatus} \n            onChange={(e) => setPurchaseStatus(e.target.value as PurchaseStatus)}\n            style={inputStyle}\n          >\n            <option value=\"Purchased\">Purchased</option>\n            <option value=\"Ordered\">Ordered</option>\n            <option value=\"Return Expected\">Return Expected</option>\n          </select>\n        </div>\n\n        <div style={inputGroupStyle}>\n          <label style={labelStyle} htmlFor=\"orderNumber\">\n            Order Number\n            <InfoIcon text=\"Optional: External reference like eBay order ID or PO number. Example: 12-34567-89012\" />\n          </label>\n          <input\n            id=\"orderNumber\"\n            type=\"text\"\n            value={orderNumber}\n            onChange={(e) => setOrderNumber(e.target.value)}\n            style={inputStyle}\n          />\n        </div>\n\n         <div style={inputGroupStyle}>\n          <label style={labelStyle} htmlFor=\"seller\">\n            Seller / Source\n            <InfoIcon text=\"Optional: Who did this item come from? Example: ebay_seller_123 or Customer Name (Return)\" />\n          </label>\n          <input\n            id=\"seller\"\n            type=\"text\"\n            value={seller}\n            onChange={(e) => setSeller(e.target.value)}\n            style={inputStyle}\n          />\n        </div>\n        \n         <div style={inputGroupStyle}>\n          <label style={labelStyle} htmlFor=\"isVatRegistered\">\n            Seller VAT Registered?\n            <InfoIcon text=\"Optional: Is the seller registered for VAT?\" />\n          </label>\n          <select \n            id=\"isVatRegistered\" \n            value={isVatRegistered} \n            onChange={(e) => setIsVatRegistered(e.target.value as 'Yes' | 'No' | 'Unknown')}\n            style={inputStyle}\n          >\n            <option value=\"Unknown\">Unknown</option>\n            <option value=\"Yes\">Yes</option>\n            <option value=\"No\">No</option>\n          </select>\n        </div>\n\n         <div style={inputGroupStyle}>\n          <label style={labelStyle} htmlFor=\"destination\">\n            Planned Destination\n            <InfoIcon text=\"Optional: Where is this item intended to go after processing? Example: FBA Prep\" />\n          </label>\n           {/* Basic dropdown + text input for custom destinations */}\n           <select \n                value={['FBA Prep', 'Local Stock Shelf A', 'Refurbish Pile', 'Return to Supplier'].includes(destination) ? destination : 'Other'}\n                onChange={(e) => {\n                    if (e.target.value === 'Other') {\n                        setDestination(''); // Clear if switching to Other for custom input\n                    } else {\n                        setDestination(e.target.value as Destination);\n                    }\n                }}\n                style={{ ...inputStyle, width: 'auto', marginRight: '10px' }}\n            >\n                <option value=\"FBA Prep\">FBA Prep</option>\n                <option value=\"Local Stock Shelf A\">Local Stock Shelf A</option>\n                <option value=\"Refurbish Pile\">Refurbish Pile</option>\n                <option value=\"Return to Supplier\">Return to Supplier</option>\n                <option value=\"Other\">Other (Specify Below)</option>\n            </select>\n            <input\n                type=\"text\"\n                placeholder=\"Specify destination...\"\n                value={destination}\n                onChange={(e) => setDestination(e.target.value)}\n                style={{ ...inputStyle, width: 'calc(50% - 26px)' }} // Adjust width\n            />\n        </div>\n\n         <div style={inputGroupStyle}>\n          <label style={labelStyle} htmlFor=\"asinSku\">\n            ASIN / SKU\n            <InfoIcon text=\"Optional: Amazon ASIN or internal SKU. Helps link inventory. Example: B0C1EXAMPLE / BLUE-WIDGET-XL\" />\n          </label>\n          <input\n            id=\"asinSku\"\n            type=\"text\"\n            value={asinSku}\n            onChange={(e) => setAsinSku(e.target.value)}\n            style={inputStyle}\n          />\n        </div>\n\n         <div style={inputGroupStyle}>\n          <label style={labelStyle} htmlFor=\"acquisitionNotes\">\n            Acquisition Notes\n            <InfoIcon text=\"Optional: Any specific notes from the purchase, order, or return request. Example: Seller mentioned slight scratch.\" />\n          </label>\n          <textarea\n            id=\"acquisitionNotes\"\n            value={acquisitionNotes}\n            onChange={(e) => setAcquisitionNotes(e.target.value)}\n            style={{ ...inputStyle, height: '60px' }}\n          />\n        </div>\n\n        {/* Flag Checkbox */}\n        <div style={{ ...inputGroupStyle, display: 'flex', alignItems: 'center' }}>\n            <input\n                type=\"checkbox\"\n                id=\"isFlagged\"\n                checked={isFlagged}\n                onChange={(e) => setIsFlagged(e.target.checked)}\n                style={{ marginRight: '10px' }} \n            />\n            <label htmlFor=\"isFlagged\" style={{ fontWeight: 'normal' }}> {/* Remove bold from checkbox label */}\n                Flag this item for follow-up\n                 <InfoIcon text=\"Check this box to mark the item with a flag for easy filtering later.\" />\n            </label>\n        </div>\n\n        {/* Buttons */}\n        <div style={{ marginTop: '20px', textAlign: 'right' }}>\n          <button type=\"button\" onClick={onClose} style={{ marginRight: '10px', padding: '8px 15px' }}>\n            Cancel\n          </button>\n          <button type=\"submit\" style={{ padding: '8px 15px', fontWeight: 'bold' }}>\n            {isEditing ? 'Update Item' : 'Save Item'}\n          </button>\n        </div>\n\n      </form>\n    </div>\n  );\n};\n\nexport default AddItemForm; ","import React from 'react';\r\nimport { StockItem, ActivityEvent } from './types';\r\n\r\ninterface ItemDetailModalProps {\r\n  item: StockItem;\r\n  onClose: () => void;\r\n  closeButtonRef?: React.RefObject<HTMLButtonElement | null>;\r\n}\r\n\r\n// Helper function to format optional fields\r\nconst formatValue = (value: string | number | undefined | null, prefix = '', suffix = '') => {\r\n  if (value === undefined || value === null || value === '') {\r\n    return <span style={{ color: '#888' }}>N/A</span>; // Indicate if not available\r\n  }\r\n  return `${prefix}${value}${suffix}`;\r\n};\r\n\r\n// Helper function to format an activity event into a readable string\r\nconst formatActivityEvent = (event: ActivityEvent): string => {\r\n  const time = new Date(event.timestamp).toLocaleString();\r\n  switch (event.type) {\r\n    case 'CREATED':\r\n      return `${time}: Item Created`;\r\n    case 'EDITED':\r\n      const fields = event.details.changedFields?.join(', ') || 'details';\r\n      return `${time}: Item Edited (${fields} changed)`;\r\n    case 'STATUS_CHANGED':\r\n      return `${time}: Status changed from ${event.details.previousStatus || '?'} to ${event.details.newStatus || '?'}`;\r\n    case 'FLAG_TOGGLED':\r\n      return `${time}: Item ${event.details.isFlagged ? 'Flagged' : 'Unflagged'}`;\r\n    case 'ISSUE_REPORTED':\r\n      return `${time}: Issue Reported: ${event.details.issueDescription || ''}`;\r\n    case 'ISSUE_UPDATE_ADDED':\r\n      return `${time}: Issue Update Added: ${event.details.note || ''}`;\r\n    case 'ISSUE_RESOLVED':\r\n      return `${time}: Issue Resolved (Outcome: ${event.details.resolutionOutcome || 'N/A'}${event.details.note ? ` - Note: ${event.details.note}` : ''}`;\r\n    case 'NOTE_ADDED': // For general notes in future\r\n      return `${time}: Note Added: ${event.details.note || ''}`;\r\n    default:\r\n      return `${time}: Unknown action`;\r\n  }\r\n};\r\n\r\nconst ItemDetailModal: React.FC<ItemDetailModalProps> = ({ item, onClose, closeButtonRef }) => {\r\n\r\n  const modalStyle: React.CSSProperties = {\r\n    backgroundColor: 'white',\r\n    padding: '20px 30px',\r\n    border: '1px solid #ccc',\r\n    borderRadius: '8px',\r\n    maxWidth: '600px',\r\n    maxHeight: '80vh', // Prevent modal from being too tall\r\n    overflowY: 'auto', // Allow scrolling if content overflows\r\n    boxShadow: '0 4px 8px rgba(0,0,0,0.1)',\r\n  };\r\n\r\n  const overlayStyle: React.CSSProperties = {\r\n    position: 'fixed',\r\n    top: 0,\r\n    left: 0,\r\n    right: 0,\r\n    bottom: 0,\r\n    backgroundColor: 'rgba(0,0,0,0.5)',\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    zIndex: 30, // Ensure it's above the AddItemForm if both were open\r\n  };\r\n\r\n  const detailRowStyle: React.CSSProperties = {\r\n    marginBottom: '10px',\r\n    paddingBottom: '10px',\r\n    borderBottom: '1px solid #eee',\r\n  };\r\n\r\n  const labelStyle: React.CSSProperties = {\r\n    fontWeight: 'bold',\r\n    display: 'inline-block',\r\n    minWidth: '150px',\r\n    marginRight: '10px',\r\n  };\r\n\r\n  const historySectionStyle: React.CSSProperties = {\r\n    marginTop: '20px',\r\n    paddingTop: '15px',\r\n    borderTop: '1px solid #ccc',\r\n  };\r\n\r\n  const historyItemStyle: React.CSSProperties = {\r\n    marginBottom: '8px',\r\n    paddingBottom: '8px',\r\n    borderBottom: '1px dashed #eee',\r\n    fontSize: '0.9em',\r\n  };\r\n\r\n  return (\r\n    <div style={overlayStyle} onClick={onClose}> {/* Close on overlay click */}\r\n      <div style={modalStyle} onClick={(e) => e.stopPropagation()}> {/* Prevent closing when clicking inside modal */}\r\n        <h3>Item Details: {item.productName} - {item.deliveryName}</h3>\r\n\r\n        <div style={detailRowStyle}>\r\n          <span style={labelStyle}>ID:</span> {item.id}\r\n        </div>\r\n        <div style={detailRowStyle}>\r\n          <span style={labelStyle}>Status:</span> {item.currentStatus}\r\n        </div>\r\n        <div style={detailRowStyle}>\r\n          <span style={labelStyle}>Product Name:</span> {item.productName}\r\n        </div>\r\n        <div style={detailRowStyle}>\r\n          <span style={labelStyle}>Delivery Name:</span> {item.deliveryName}\r\n        </div>\r\n        <div style={detailRowStyle}>\r\n          <span style={labelStyle}>Quantity:</span> {item.quantity}\r\n        </div>\r\n        <div style={detailRowStyle}>\r\n          <span style={labelStyle}>Price Per Item:</span> {formatValue(item.pricePerItem, '')}\r\n        </div>\r\n        <div style={detailRowStyle}>\r\n          <span style={labelStyle}>Order Date:</span> {item.orderDate}\r\n        </div>\r\n        <div style={detailRowStyle}>\r\n          <span style={labelStyle}>Purchase Status:</span> {formatValue(item.purchaseStatus)}\r\n        </div>\r\n        <div style={detailRowStyle}>\r\n          <span style={labelStyle}>Order Number:</span> {formatValue(item.orderNumber)}\r\n        </div>\r\n        <div style={detailRowStyle}>\r\n          <span style={labelStyle}>Seller / Source:</span> {formatValue(item.seller)}\r\n        </div>\r\n        <div style={detailRowStyle}>\r\n          <span style={labelStyle}>Seller VAT Reg?:</span> {formatValue(item.isVatRegistered)}\r\n        </div>\r\n        <div style={detailRowStyle}>\r\n          <span style={labelStyle}>Planned Destination:</span> {formatValue(item.destination)}\r\n        </div>\r\n        <div style={detailRowStyle}>\r\n          <span style={labelStyle}>ASIN / SKU:</span> {formatValue(item.asinSku)}\r\n        </div>\r\n        <div style={detailRowStyle}>\r\n          <span style={labelStyle}>Acquisition Notes:</span> {formatValue(item.acquisitionNotes)}\r\n        </div>\r\n        <div style={detailRowStyle}>\r\n          <span style={labelStyle}>Date Delivered:</span> {formatValue(item.dateDelivered ? new Date(item.dateDelivered).toLocaleString() : undefined)}\r\n        </div>\r\n         <div style={detailRowStyle}>\r\n          <span style={labelStyle}>Processor Notes:</span> {formatValue(item.processorNotes)}\r\n        </div>\r\n        <div style={{ ...detailRowStyle, borderBottom: 'none' }}> {/* Remove border on last item */}\r\n          <span style={labelStyle}>Issue Description:</span> {formatValue(item.issueDescription)}\r\n        </div>\r\n\r\n        {/* --- History Section --- */}\r\n        {(item.activityLog && item.activityLog.length > 0) && (\r\n          <div style={historySectionStyle}>\r\n            <h4>History / Activity Log</h4>\r\n            {/* Display newest first */}\r\n            {[...(item.activityLog)].reverse().map((event, index) => (\r\n              <div key={`${event.timestamp}-${index}`} style={historyItemStyle}>\r\n                {formatActivityEvent(event)}\r\n              </div>\r\n            ))}\r\n          </div>\r\n        )}\r\n\r\n        <div style={{ marginTop: '20px', textAlign: 'right' }}>\r\n          <button\r\n            ref={closeButtonRef}\r\n            onClick={onClose}\r\n            style={{ padding: '8px 15px', fontWeight: 'bold' }}\r\n          >\r\n            Close\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ItemDetailModal; ","import { initializeApp } from 'firebase/app';\nimport { getAuth } from 'firebase/auth';\nimport { getFirestore } from 'firebase/firestore';\nimport React, { useState, useRef, useEffect, useCallback } from \"react\";\nimport {\n    DndContext,\n    closestCenter,\n    KeyboardSensor,\n    PointerSensor,\n    useSensor,\n    useSensors,\n    DragEndEvent,\n} from '@dnd-kit/core';\nimport {\n    arrayMove,\n    SortableContext,\n    sortableKeyboardCoordinates,\n    useSortable,\n    horizontalListSortingStrategy,\n} from '@dnd-kit/sortable';\nimport { CSS } from '@dnd-kit/utilities';\nimport { StockItem, ItemStatus, ActivityEvent, ActivityEventType } from './types'; // Import the interface\nimport AddItemForm from './AddItemForm'; // Import the form component\nimport ItemDetailModal from './ItemDetailModal'; // Import the details modal\nimport ReportIssueModal from './ReportIssueModal'; // Import the new modal\nimport AddUpdateModal from './AddUpdateModal'; // Import the new modal\nimport ResolveIssueModal from './ResolveIssueModal'; // Import the new modal\nimport TableSettingsModal from './TableSettingsModal'; // Import the new modal\nimport {\n  collection,\n  doc,\n  onSnapshot,\n  addDoc,\n  updateDoc,\n  serverTimestamp,\n  query,\n  orderBy\n} from 'firebase/firestore';\nimport { User as FirebaseUser } from \"firebase/auth\"; // Import Auth related types and functions\nimport { LogActionData } from 'shell-log-service'; // Import only the type, not the function\n\n// Utility to remove undefined fields before saving to Firestore\nfunction removeUndefinedFields(obj: Record<string, any>) {\n  return Object.fromEntries(Object.entries(obj).filter(([_, v]) => v !== undefined));\n}\n\n// Define the props interface for ToolApp\nexport interface ToolAppProps {\n  user: FirebaseUser | null; // Use FirebaseUser type\n  org: any; // Replace 'any' with a specific org type if available\n  permissions: string[];\n  logAction?: (data: LogActionData) => Promise<void>; // Add logAction prop\n}\n\n// Remove placeholder definitions\n// const ReportIssueModal = ...\n// const AddUpdateModal = ...; // Remove this placeholder definition\n// const ResolveIssueModal = ({ onSubmit, onClose }: { onSubmit: (outcome: string, note?: string) => void, onClose: () => void }) => <div style={{position:'fixed', top:'40%', left:'40%', background:'lightgreen', border:'1px solid black', padding:20, zIndex:50}}>Resolve Issue Placeholder<button onClick={() => onSubmit(prompt('Outcome?') || 'Accepted', prompt('Notes?') || '')}>Save</button><button onClick={onClose}>Cancel</button></div>;\n\n// --- Placeholder Components (to be implemented later) ---\nconst SearchBar = ({ onSearch, inputRef }: { onSearch: (term: string) => void, inputRef?: React.RefObject<HTMLInputElement | null> }) => (\n  <input\n    ref={inputRef}\n    type=\"text\"\n    placeholder=\"Search by Delivery Name or Product Name...\"\n    onChange={e => onSearch(e.target.value)}\n    style={{ marginBottom: '1rem', padding: '0.5rem', width: '100%' }}\n  />\n);\n\nconst FilterTabs = ({ currentFilter, onFilterChange }: { currentFilter: ItemStatus | 'All'; onFilterChange: (filter: ItemStatus | 'All') => void }) => {\n  const filters: (ItemStatus | 'All')[] = ['All', 'Pending Delivery', 'Delivered', 'Issue', 'Late', 'Archived']; // Added Delivered & Archived\n  return (\n    <div style={{ marginBottom: '1rem' }}>\n      {filters.map(filter => (\n        <button\n          key={filter}\n          onClick={() => onFilterChange(filter)}\n          style={{ fontWeight: currentFilter === filter ? 'bold' : 'normal', marginRight: '0.5rem', padding: '0.5rem' }}\n        >\n          {filter}\n        </button>\n      ))}\n    </div>\n  );\n};\n\n// --- Helper Functions ---\n// Function to check if an item is late (Pending Delivery and Order Date > 7 days ago)\nconst isItemLate = (item: StockItem): boolean => {\n  if (item.currentStatus !== 'Pending Delivery') {\n    return false;\n  }\n  const orderDate = new Date(item.orderDate);\n  const sevenDaysAgo = new Date();\n  sevenDaysAgo.setDate(sevenDaysAgo.getDate() - 7);\n  return orderDate < sevenDaysAgo;\n};\n\nconst getStatusStyle = (status: ItemStatus, isLate: boolean, isFlagged?: boolean): React.CSSProperties => { // Added isFlagged\n  // Basic style adjustments for flagged items (e.g., slightly bolder border or specific color)\n  const flaggedStyle: React.CSSProperties = isFlagged ? { borderLeft: '3px solid red' } : {}; // Example: Red left border\n  \n  let baseStyle: React.CSSProperties = {};\n  if (status === 'Pending Delivery' && isLate) {\n    baseStyle = { backgroundColor: '#cce5ff', color: '#004085' }; // Light Blue for Late\n  } else {\n    switch (status) {\n      case 'Pending Delivery': baseStyle = { backgroundColor: '#fff3cd', color: '#856404' }; break;\n      case 'Delivered': baseStyle = { backgroundColor: '#d4edda', color: '#155724' }; break;\n      case 'Issue': baseStyle = { backgroundColor: '#f8d7da', color: '#721c24' }; break;\n      case 'Archived': baseStyle = { backgroundColor: '#e2e3e5', color: '#383d41' }; break;\n      default: baseStyle = {}; break;\n    }\n  }\n  return { ...baseStyle, ...flaggedStyle }; // Combine base style with flagged indicator\n};\n\n// Function to create a new ActivityEvent\nconst createActivityEvent = (\n    userId: string, // Add userId parameter\n    type: ActivityEventType,\n    details: ActivityEvent['details'] = {}\n): ActivityEvent => ({\n    timestamp: new Date().toISOString(),\n    type,\n    userId, // Include userId in the returned object\n    details,\n});\n\n// Function to determine available actions based on status\nconst getAvailableActions = (status: ItemStatus, isFlagged?: boolean): string[] => {\n  let actions: string[] = [];\n  switch (status) {\n    case 'Pending Delivery':\n      actions = ['Mark as Delivered', 'Report Issue', 'View Details', 'Edit Item']; break;\n    case 'Delivered':\n      actions = ['Archive', 'Report Issue', 'View Details', 'Edit Item']; break;\n    case 'Issue': // Issue-specific actions\n      actions = ['Resolve Issue', 'Add Issue Update', 'Archive', 'View Details', 'Edit Item']; break;\n    case 'Late': \n      actions = ['Mark as Delivered', 'Report Issue', 'View Details', 'Edit Item']; break;\n    case 'Archived':\n      actions = ['View Details']; break;\n    default:\n      actions = ['View Details']; break;\n  }\n  if (status !== 'Archived') {\n    actions.unshift(isFlagged ? 'Unflag Item' : 'Flag Item');\n  }\n  return actions;\n};\n\n// Simple Action Menu Component\ninterface ActionMenuProps {\n  itemId: string;\n  actions: string[];\n  onActionSelected: (itemId: string, action: string) => void;\n  onClose: () => void;\n}\n\nconst ActionMenu: React.FC<ActionMenuProps> = ({ itemId, actions, onActionSelected, onClose }) => {\n  const menuRef = useRef<HTMLDivElement>(null);\n\n  // Close menu if clicked outside\n  useEffect(() => {\n    const handleClickOutside = (event: MouseEvent) => {\n      if (menuRef.current && !menuRef.current.contains(event.target as Node)) {\n        onClose();\n      }\n    };\n    document.addEventListener('mousedown', handleClickOutside);\n    return () => {\n      document.removeEventListener('mousedown', handleClickOutside);\n    };\n  }, [onClose]);\n\n  return (\n    <div ref={menuRef} style={{\n      position: 'absolute',\n      backgroundColor: 'white',\n      border: '1px solid #ccc',\n      borderRadius: '4px',\n      boxShadow: '0 2px 5px rgba(0,0,0,0.15)',\n      zIndex: 10, // Ensure it appears above other elements\n      minWidth: '150px',\n      marginTop: '2px' // Small gap below the button\n    }}>\n      {actions.map(action => (\n        <button\n          key={action}\n          onClick={() => onActionSelected(itemId, action)}\n          style={{\n            display: 'block',\n            width: '100%',\n            padding: '8px 12px',\n            border: 'none',\n            background: 'none',\n            textAlign: 'left',\n            cursor: 'pointer'\n          }}\n          onMouseEnter={(e) => (e.currentTarget.style.backgroundColor = '#f0f0f0')}\n          onMouseLeave={(e) => (e.currentTarget.style.backgroundColor = 'transparent')}\n        >\n          {action}\n        </button>\n      ))}\n    </div>\n  );\n};\n\n// --- Configuration ---\nexport interface ColumnConfig {\n  id: keyof StockItem | 'actions'; // Use StockItem keys + custom 'actions' key\n  label: string;\n}\n\n// Define all possible columns (excluding activityLog for direct table display)\nconst ALL_COLUMNS: ColumnConfig[] = [\n  { id: 'orderDate', label: 'Order Date' },\n  { id: 'quantity', label: 'Qty' },\n  { id: 'productName', label: 'Product Name' },\n  { id: 'deliveryName', label: 'Delivery Name' },\n  { id: 'pricePerItem', label: 'Price/Item' },\n  { id: 'seller', label: 'Seller/Source' },\n  { id: 'destination', label: 'Destination' },\n  { id: 'asinSku', label: 'ASIN/SKU' },\n  { id: 'purchaseStatus', label: 'Purchase Status' },\n  { id: 'orderNumber', label: 'Order #' },\n  { id: 'currentStatus', label: 'Status' },\n  { id: 'isFlagged', label: 'Flagged' },\n  { id: 'acquisitionNotes', label: 'Acquisition Notes' },\n  { id: 'issueDescription', label: 'Issue Description' },\n  { id: 'dateDelivered', label: 'Date Delivered' },\n  { id: 'actions', label: 'Actions' },\n];\n\n// Default visible columns (keys/ids)\nconst DEFAULT_VISIBLE_COLUMN_IDS: Array<ColumnConfig['id']> = [\n    'orderDate', \n    'quantity', \n    'productName', \n    'deliveryName', \n    'currentStatus', \n    'actions',\n];\n\nconst LOCAL_STORAGE_KEY_VISIBLE_COLUMNS = 'incomingTool_visibleColumns';\n\n// --- Firestore Data ---\n\n// --- Draggable Header Component ---\ninterface DraggableHeaderProps {\n  col: ColumnConfig;\n}\n\nconst DraggableHeader: React.FC<DraggableHeaderProps> = ({ col }) => {\n  const {\n    attributes,\n    listeners,\n    setNodeRef,\n    transform,\n    transition,\n    isDragging,\n  } = useSortable({ id: col.id });\n\n  const style: React.CSSProperties = {\n    transform: CSS.Translate.toString(transform),\n    transition,\n    opacity: isDragging ? 0.8 : 1,\n    zIndex: isDragging ? 10 : 1, // Ensure dragged header is above others\n    cursor: 'move',\n    border: '1px solid #ccc',\n    padding: '8px',\n    textAlign: col.id === 'actions' ? 'center' : 'left',\n    backgroundColor: isDragging ? '#e0e0e0' : '#f2f2f2' // Highlight when dragging\n  };\n\n  return (\n    <th ref={setNodeRef} style={style} {...attributes} {...listeners}>\n      {col.label}\n    </th>\n  );\n};\n\n// Update StockProcessingList props to accept onColumnReorder\nconst StockProcessingList = ({\n  items,\n  visibleColumns, // Pass the ordered list of visible column configs\n  onActionSelected,\n  onViewDetails,\n  onColumnReorder, // Add prop for reordering columns\n  selectedRowIndex = -1\n}: {\n  items: StockItem[];\n  visibleColumns: ColumnConfig[];\n  onActionSelected: (itemId: string, action: string) => void;\n  onViewDetails: (itemId: string) => void;\n  onColumnReorder: (event: DragEndEvent) => void; // Type for dnd-kit event\n  selectedRowIndex?: number;\n}) => {\n  const [openMenuId, setOpenMenuId] = useState<string | null>(null);\n\n  // dnd-kit sensors\n  const sensors = useSensors(\n    useSensor(PointerSensor),\n    useSensor(KeyboardSensor, {\n      coordinateGetter: sortableKeyboardCoordinates,\n    })\n  );\n\n  const handleMenuToggle = (itemId: string) => {\n    setOpenMenuId(prevId => (prevId === itemId ? null : itemId));\n  };\n\n  const handleCloseMenu = () => {\n    setOpenMenuId(null);\n  };\n\n  const handleAction = (itemId: string, action: string) => {\n    if (action === 'View Details') {\n      onViewDetails(itemId);\n    } else {\n      onActionSelected(itemId, action);\n    }\n    handleCloseMenu();\n  };\n\n  // Function to render cell content based on column ID\n  const renderCellContent = (item: StockItem, columnId: ColumnConfig['id']) => {\n    // Helper for potentially null/undefined primitives\n    const renderPrimitive = (value: string | number | boolean | null | undefined) => {\n        if (typeof value === 'string' || typeof value === 'number') {\n          return value;\n        } else if (typeof value === 'boolean') {\n          return value ? 'Yes' : 'No';\n        }\n        return '-'; // Default for null/undefined\n    };\n\n    switch (columnId) {\n        case 'isFlagged':\n            return <td key={columnId} style={{ border: '1px solid #ccc', padding: '8px', textAlign: 'center' }}>{item.isFlagged ? '' : ''}</td>;\n        case 'actions': \n            return (\n                <td \n                  key={'actions'} \n                  style={{ border: '1px solid #ccc', padding: '0px', textAlign: 'center', position: 'relative' }} \n                  onClick={(e) => e.stopPropagation()} \n                >\n                   {item.currentStatus !== 'Archived' && (\n                    <button\n                        style={{ cursor: 'pointer', border: 'none', background: 'none', fontSize: '1.2em', padding: '8px' }}\n                        title=\"Actions\"\n                        onClick={(e) => { e.stopPropagation(); handleMenuToggle(item.id); }}\n                    >\n                        \n                    </button>\n                  )}\n                  {openMenuId === item.id && (\n                    <ActionMenu\n                        itemId={item.id}\n                        actions={getAvailableActions(item.currentStatus, item.isFlagged)}\n                        onActionSelected={handleAction}\n                        onClose={handleCloseMenu}\n                    />\n                  )}\n                </td>\n            );\n        case 'currentStatus':\n             const isLate = isItemLate(item); \n             return (\n                 <td \n                    key={columnId} \n                    style={{ border: '1px solid #ccc', padding: '8px', ...getStatusStyle(item.currentStatus, isLate, item.isFlagged) }} \n                    onClick={(e) => e.stopPropagation()}\n                 >\n                    {item.currentStatus}\n                 </td>\n             );\n         case 'quantity':\n         case 'pricePerItem':\n            const numValue = item[columnId as keyof StockItem];\n            return <td key={columnId} style={{ border: '1px solid #ccc', padding: '8px', textAlign: 'right' }}>{typeof numValue === 'number' ? numValue : '-'}</td>;\n        case 'dateDelivered': \n        case 'orderDate':\n             const dateValue = item[columnId as keyof StockItem];\n             // Format date or show hyphen\n             const formattedDate = typeof dateValue === 'string' && dateValue ? new Date(dateValue).toLocaleDateString() : '-';\n             return <td key={columnId} style={{ border: '1px solid #ccc', padding: '8px' }}>{formattedDate}</td>; \n        case 'acquisitionNotes':\n        case 'issueDescription':\n            // These *could* technically have other types if StockItem changes, so explicitly check for string\n            const noteValue = item[columnId];\n            return <td key={columnId} style={{ border: '1px solid #ccc', padding: '8px' }}>{typeof noteValue === 'string' ? renderPrimitive(noteValue) : '-'}</td>;\n        // Explicit cases for all other configured string/nullable columns\n        case 'productName':\n        case 'deliveryName':\n        case 'seller':\n        case 'destination':\n        case 'asinSku':\n        case 'purchaseStatus':\n        case 'orderNumber':\n            // These are expected to be string | undefined based on StockItem type\n            return <td key={columnId} style={{ border: '1px solid #ccc', padding: '8px' }}>{renderPrimitive(item[columnId])}</td>;\n        // Default case should ideally not be hit if ALL_COLUMNS is exhaustive\n        default: \n             console.warn(\"Unhandled column ID in renderCellContent:\", columnId);\n             return <td key={columnId} style={{ border: '1px solid #ccc', padding: '8px' }}>???</td>; \n    }\n  };\n\n  return (\n    <div>\n      <h4>Stock & Processing List</h4>\n      <DndContext\n        sensors={sensors}\n        collisionDetection={closestCenter}\n        onDragEnd={onColumnReorder}\n      >\n        <SortableContext\n          items={visibleColumns.map(col => col.id)}\n          strategy={horizontalListSortingStrategy}\n        >\n          <table style={{ width: '100%', borderCollapse: 'collapse', border: '1px solid #ccc' }}>\n            <thead>\n              <tr style={{ backgroundColor: '#f2f2f2' }}>\n                {visibleColumns.map(col => (\n                  <DraggableHeader key={col.id} col={col} />\n                ))}\n              </tr>\n            </thead>\n            <tbody>\n              {items.length > 0 ? items.map((item, idx) => {\n                const isSelected = idx === selectedRowIndex;\n                return (\n                  <tr key={item.id} style={isSelected ? { background: '#e3f0ff', outline: '2px solid #1976d2' } : {}}>\n                    {visibleColumns.map(col => renderCellContent(item, col.id))}\n                  </tr>\n                );\n              }) : (\n                <tr>\n                  <td colSpan={visibleColumns.length} style={{ border: '1px solid #ccc', padding: '16px', textAlign: 'center' }}>\n                    No items match the current filter.\n                  </td>\n                </tr>\n              )}\n            </tbody>\n          </table>\n        </SortableContext>\n      </DndContext>\n    </div>\n  );\n};\n\nconst AddItemButton = ({ onClick }: { onClick: () => void }) => (\n  <button onClick={onClick} style={{ marginTop: '1rem', padding: '0.8rem 1.5rem', cursor: 'pointer' }}>\n    + Add New Item\n  </button>\n);\n\n// Component for the Flag Toggle Switch\nconst FlagToggle = ({ isChecked, onChange }: { isChecked: boolean; onChange: (checked: boolean) => void }) => (\n  <div style={{ marginLeft: 'auto', display: 'flex', alignItems: 'center' }}> {/* Push to the right */} \n    <label htmlFor=\"flagToggle\" style={{ marginRight: '8px', fontWeight: 'bold' }}>Show Flagged Only:</label>\n    <input \n      type=\"checkbox\" \n      id=\"flagToggle\"\n      checked={isChecked}\n      onChange={(e) => onChange(e.target.checked)}\n      style={{ width: '20px', height: '20px' }} // Basic styling for visibility\n    />\n  </div>\n);\n\n\n// --- Keyboard Shortcuts Help Modal ---\nconst HelpModal = ({ onClose }: { onClose: () => void }) => (\n  <div style={{\n    position: 'fixed', top: 0, left: 0, right: 0, bottom: 0,\n    background: 'rgba(0,0,0,0.5)', zIndex: 100, display: 'flex', alignItems: 'center', justifyContent: 'center'\n  }}>\n    <div style={{ background: 'white', padding: 32, borderRadius: 8, minWidth: 400 }}>\n      <h3>Keyboard Shortcuts</h3>\n      <ul style={{ lineHeight: 2 }}>\n        <li><b>/</b>  Focus search bar</li>\n        <li><b>a</b>  Add new item</li>\n        <li><b>c</b>  Open columns/settings</li>\n        <li><b>f</b>  Toggle flagged only</li>\n        <li><b>1-6</b>  Switch filter tabs</li>\n        <li><b>?</b>  Show this help</li>\n        <li><b>Arrow Up/Down</b>  Move row selection</li>\n        <li><b>Enter/o</b>  View details for selected row</li>\n        <li><b>e</b>  Edit selected row</li>\n        <li><b>r</b>  Report issue for selected row</li>\n        <li><b>l</b>  Flag/unflag selected row</li>\n        <li><b>Esc</b>  Close any open modal</li>\n      </ul>\n      <button autoFocus onClick={onClose} style={{ marginTop: 16, padding: '8px 20px' }}>Close</button>\n    </div>\n  </div>\n);\n\n// --- Main Tool Component ---\n\n// --- IMPORTANT: Replace with your actual Firebase config ---\nconst firebaseConfig = {\n  apiKey: process.env.REACT_APP_FIREBASE_API_KEY,\n  authDomain: process.env.REACT_APP_FIREBASE_AUTH_DOMAIN,\n  projectId: process.env.REACT_APP_FIREBASE_PROJECT_ID,\n  storageBucket: process.env.REACT_APP_FIREBASE_STORAGE_BUCKET,\n  messagingSenderId: process.env.REACT_APP_FIREBASE_MESSAGING_SENDER_ID,\n  appId: process.env.REACT_APP_FIREBASE_APP_ID\n};\n\n// Optionally, throw if any are missing (for dev safety)\nObject.entries(firebaseConfig).forEach(([key, value]) => {\n  if (!value) {\n    throw new Error(`Missing Firebase config value for ${key}. Did you set your .env file?`);\n  }\n});\n\nconst app = initializeApp(firebaseConfig);\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nconst auth = getAuth(app); // Needed for Firestore permissions, silence unused warning\nconst db = getFirestore(app);\n\nconst ToolApp: React.FC<ToolAppProps> = ({ user, org, permissions, logAction }) => {\n  // Log received props, especially logAction\n  console.log('ToolApp Props Received:', { user, orgId: org?.id, permissions, logActionExists: !!logAction });\n\n  // Row selection state\n  const [selectedRowIndex, setSelectedRowIndex] = useState<number>(-1);\n  const [isHelpModalOpen, setIsHelpModalOpen] = useState<boolean>(false);\n\n  const [allItems, setAllItems] = useState<StockItem[]>([]);\n  const [loading, setLoading] = useState<boolean>(true);\n  const [error, setError] = useState<string | null>(null);\n  const [searchTerm, setSearchTerm] = useState<string>('');\n  const [currentFilter, setCurrentFilter] = useState<ItemStatus | 'All'>('Pending Delivery'); // Default filter\n  const [selectedItemDetails, setSelectedItemDetails] = useState<StockItem | null>(null); // For View Details Modal\n  const [isAddItemModalOpen, setIsAddItemModalOpen] = useState<boolean>(false); // State for modal visibility\n  const [showFlaggedOnly, setShowFlaggedOnly] = useState<boolean>(false); // State for flag toggle\n  const [editingItem, setEditingItem] = useState<StockItem | null>(null); // State to hold item being edited\n  // State for new modals\n  const [reportingIssueItem, setReportingIssueItem] = useState<StockItem | null>(null);\n  const [addingUpdateItem, setAddingUpdateItem] = useState<StockItem | null>(null);\n  const [resolvingIssueItem, setResolvingIssueItem] = useState<StockItem | null>(null);\n  const [isSettingsModalOpen, setIsSettingsModalOpen] = useState(false); // State for settings modal\n\n  // State for column configuration (order matters now)\n  const [visibleColumnIds, setVisibleColumnIds] = useState<Array<ColumnConfig['id']>>(() => {\n    try {\n      const stored = localStorage.getItem(LOCAL_STORAGE_KEY_VISIBLE_COLUMNS);\n      // Ensure stored value is an array, otherwise use default\n      const parsed = stored ? JSON.parse(stored) : DEFAULT_VISIBLE_COLUMN_IDS;\n      return Array.isArray(parsed) ? parsed : DEFAULT_VISIBLE_COLUMN_IDS;\n    } catch (error) {\n      console.error(\"Error reading visible columns from localStorage\", error);\n      return DEFAULT_VISIBLE_COLUMN_IDS;\n    }\n  });\n  \n  // Save visible columns to localStorage whenever they change\n  useEffect(() => {\n    try {\n        localStorage.setItem(LOCAL_STORAGE_KEY_VISIBLE_COLUMNS, JSON.stringify(visibleColumnIds));\n    } catch (error) {\n        console.error(\"Error saving visible columns to localStorage\", error);\n    }\n  }, [visibleColumnIds]);\n\n  // Derive visible columns based on IDs state (order is now determined by visibleColumnIds)\n  const visibleColumns = visibleColumnIds\n      .map(id => ALL_COLUMNS.find(col => col.id === id))\n      .filter((col): col is ColumnConfig => col !== undefined); // Filter out undefined if an ID becomes invalid\n\n  // Update filtering logic to include flag toggle\n  const filteredItems = allItems.filter(item => { // filteredItems is the displayed array\n\n    const matchesSearch = \n      !searchTerm || \n      item.deliveryName.toLowerCase().includes(searchTerm.toLowerCase()) ||\n      item.productName.toLowerCase().includes(searchTerm.toLowerCase());\n      \n    let matchesFilter = false;\n    if (currentFilter === 'All') {\n        matchesFilter = true;\n    } else if (currentFilter === 'Late') {\n        // Show items that are pending and meet the late criteria\n        matchesFilter = isItemLate(item);\n    } else {\n        // Standard status matching, but don't show late items unless 'Late' or 'All' filter is selected\n        // Or should late items still appear in Pending Delivery? Let's keep them there for now.\n        matchesFilter = item.currentStatus === currentFilter;\n    }\n\n    // Apply flag filter if toggle is on\n    const matchesFlag = !showFlaggedOnly || item.isFlagged === true;\n\n    return matchesFilter && matchesSearch && matchesFlag; // Add flag condition\n  });\n\n  // Clamp selectedRowIndex if filteredItems changes\n  useEffect(() => {\n    setSelectedRowIndex(idx => {\n      if (filteredItems.length === 0) return -1;\n      if (idx < 0) return 0;\n      if (idx >= filteredItems.length) return filteredItems.length - 1;\n      return idx;\n    });\n  }, [filteredItems]);\n\n  // --- Firestore Real-time Sync ---\n  useEffect(() => {\n    if (!org?.id) return;\n    setLoading(true);\n    setError(null);\n    const q = query(collection(db, 'orgs', org.id, 'stockItems'), orderBy('orderDate', 'desc'));\n    const unsub = onSnapshot(q, (snapshot) => {\n      const items: StockItem[] = snapshot.docs.map(docSnap => ({ id: docSnap.id, ...docSnap.data() })) as StockItem[];\n      setAllItems(items);\n      setLoading(false);\n    }, (err) => {\n      setError('Failed to load items: ' + err.message);\n      setLoading(false);\n    });\n    return () => unsub();\n  }, [org?.id]); // db is stable, remove from deps\n\n  // Placeholder functions for actions\n  const handleSearch = (term: string) => {\n    setSearchTerm(term);\n  };\n\n\n  const handleFilterChange = (filter: ItemStatus | 'All') => {\n    setCurrentFilter(filter);\n  };\n\n  // Centralized function to update item in Firestore and add log entry\n  const updateItemAndLog = useCallback(async (itemId: string, userId: string | undefined, changes: Partial<StockItem>, event: ActivityEvent) => {\n    if (!db || !org?.id || !userId) {\n      console.error('Cannot update item: Missing configuration.', { db: !!db, orgId: org?.id, userId });\n      setError('Cannot update item: Missing configuration.');\n      return;\n    }\n\n    const itemRef = doc(db, 'orgs', org.id, 'stockItems', itemId);\n    const itemBefore = allItems.find(i => i.id === itemId);\n    if (!itemBefore) {\n        console.error(`Item ${itemId} not found for update`);\n        setError(`Item ${itemId} not found.`);\n        return;\n    }\n\n    // Combine updates with new activity event and timestamp\n    const finalUpdates = removeUndefinedFields({\n      ...changes,\n      activityLog: [...(itemBefore.activityLog || []), event],\n      lastUpdated: serverTimestamp(),\n    });\n\n    const itemAfter = { ...itemBefore, ...finalUpdates }; // Approximate state after update\n\n    try {\n      await updateDoc(itemRef, finalUpdates);\n      console.log(`Item ${itemId} updated successfully.`);\n\n      // Log the generic update action\n      console.log('updateItemAndLog: Attempting to log action. logAction available?', !!logAction);\n      if (logAction) {\n        // Determine standardized action name\n        let actionName: string; // Declare as string, no initial value\n        try {\n          if (event.type === 'EDITED') {\n            actionName = 'item.update.fields';\n          } else if (event.type === 'FLAG_TOGGLED') {\n            actionName = 'item.update.flag';\n          } else if (event.type === 'STATUS_CHANGED') {\n            const newStatus = event.details?.newStatus?.toLowerCase() || 'unknown';\n            actionName = `item.update.status.${newStatus}`;\n          } else if (event.type === 'ISSUE_UPDATE_ADDED') {\n            actionName = 'item.update.issue.addNote';\n          } else {\n             actionName = event.type; // Fallback to original event type\n          }\n          // Add more mappings as needed\n        } catch (nameError) {\n          console.error(\"Error deriving action name for logging:\", nameError);\n          actionName = event.type; // Use original type on error\n        }\n\n        // Construct the data payload ensuring types match LogActionData\n        const logData: LogActionData = {\n           orgId: org.id,\n           toolKey: 'incomingtool',\n           action: actionName, // actionName is now guaranteed to be string\n           entityPath: `stockItems/${itemId}`,\n           // Conditionally add before/after/details if they exist\n           ...(itemBefore !== undefined && { before: itemBefore }),\n           ...(itemAfter !== undefined && { after: itemAfter }),\n           ...(event.details !== undefined && { details: event.details })\n        };\n\n        await logAction(logData); // Pass the correctly typed object\n\n      }\n\n    } catch (e) {\n      console.error(`Error updating item ${itemId}:`, e);\n      setError(`Failed to update item: ${(e as Error).message}`);\n      throw e; // Re-throw error to be caught by calling handler if needed\n    }\n  }, [org, allItems, logAction]);\n\n  // Update handleItemAction to dispatch to specific handlers or generic updates\n  const handleItemAction = useCallback(async (itemId: string, action: string) => {\n    console.log(`Action: ${action} on item ${itemId}`);\n    const item = allItems.find(i => i.id === itemId);\n    if (!item) return;\n\n    switch (action) {\n      case 'Edit Item':\n        setEditingItem(item);\n        setIsAddItemModalOpen(true);\n        break;\n      case 'Flag Item':\n      case 'Unflag Item':\n        const newFlagState = action === 'Flag Item';\n        await updateItemAndLog(itemId, user?.uid, \n          { isFlagged: newFlagState }, \n          createActivityEvent(user?.uid || '', 'FLAG_TOGGLED', { isFlagged: newFlagState })\n        );\n        break;\n      case 'Mark as Delivered':\n        if (item.currentStatus !== 'Delivered') {\n          await updateItemAndLog(itemId, user?.uid,\n            { currentStatus: 'Delivered', dateDelivered: new Date().toISOString() },\n            createActivityEvent(user?.uid || '', 'STATUS_CHANGED', { previousStatus: item.currentStatus, newStatus: 'Delivered' })\n          );\n        }\n        break;\n      case 'Archive':\n         if (item.currentStatus !== 'Archived') {\n          await updateItemAndLog(itemId, user?.uid, \n            { currentStatus: 'Archived' },\n            createActivityEvent(user?.uid || '', 'STATUS_CHANGED', { previousStatus: item.currentStatus, newStatus: 'Archived' })\n          );\n         }\n        break;\n      // Default case for actions handled elsewhere or needing no state change here (like View Details)\n    }\n  }, [user?.uid, allItems, updateItemAndLog, setEditingItem, setIsAddItemModalOpen]);\n\n  // *** RESTORED HANDLERS START ***\n\n  // Handler for reporting an issue\n  const handleSaveReportIssue = useCallback(async (description: string) => {\n    if (!reportingIssueItem || !org?.id || !db) return;\n    const itemId = reportingIssueItem.id;\n    // Add ISSUE_REPORTED event\n    const reportEvent = createActivityEvent(user?.uid || '', 'ISSUE_REPORTED', { issueDescription: description });\n    // Add STATUS_CHANGED event\n    try {\n      const itemRef = doc(db, 'orgs', org.id, 'stockItems', itemId);\n      await updateDoc(itemRef, {\n        currentStatus: 'Issue',\n        issueDescription: description,\n        activityLog: [...(allItems.find(item => item.id === itemId)?.activityLog || []), reportEvent], // Only add the primary reportEvent\n        lastUpdated: serverTimestamp(),\n      });\n       // Log action (could potentially use updateItemAndLog, but this involves multiple events)\n       const itemBefore = allItems.find(item => item.id === itemId);\n       console.log('handleSaveReportIssue: Attempting to log action. logAction available?', !!logAction);\n       if (logAction) {\n         await logAction({\n           orgId: org.id,\n           toolKey: 'incomingtool',\n           action: 'item.update.issue.report', // Standardized action name\n           entityPath: `stockItems/${itemId}`,\n           before: itemBefore,\n           after: { ...itemBefore, currentStatus: 'Issue', issueDescription: description }, // Approximate state after update\n           details: { issueDescription: description }\n         });\n       }\n      setReportingIssueItem(null); // Close modal\n    } catch (err) {\n      setError('Failed to report issue: ' + (err as Error).message);\n    }\n  }, [reportingIssueItem, org?.id, user?.uid, allItems, logAction, setReportingIssueItem, setError]);\n\n  // Handler for adding an issue update note\n  const handleSaveIssueUpdate = useCallback(async (note: string) => {\n    if (!addingUpdateItem) return;\n    try {\n      await updateItemAndLog(\n        addingUpdateItem.id,\n        user?.uid,\n        {},\n        createActivityEvent(user?.uid || '', 'ISSUE_UPDATE_ADDED', { note })\n      );\n      setAddingUpdateItem(null); // Close modal\n    } catch (err) {\n      // Error is already logged by updateItemAndLog\n      // setError('Failed to add issue update: ' + (err as Error).message);\n    }\n  }, [addingUpdateItem, updateItemAndLog, setAddingUpdateItem, user?.uid]);\n\n  // Handler for resolving an issue\n  const handleSaveResolveIssue = useCallback(async (outcome: string, note?: string) => {\n    if (!resolvingIssueItem || !org?.id || !db) return;\n    const itemId = resolvingIssueItem.id;\n    // Determine new status based on outcome\n    let newStatus: ItemStatus = 'Delivered'; // Default\n    if (outcome === 'Returned to Supplier' || outcome === 'Disposed Of') {\n      newStatus = 'Archived';\n    }\n    // Could add more outcomes mapping to statuses\n\n    const resolveEvent = createActivityEvent(user?.uid || '', 'ISSUE_RESOLVED', { resolutionOutcome: outcome, note });\n    try {\n      const itemRef = doc(db, 'orgs', org.id, 'stockItems', itemId);\n      await updateDoc(itemRef, {\n        currentStatus: newStatus,\n        activityLog: [...(allItems.find(item => item.id === itemId)?.activityLog || []), resolveEvent], // Only add the primary resolveEvent\n        lastUpdated: serverTimestamp(),\n      });\n      // Log action\n      const itemBefore = allItems.find(item => item.id === itemId);\n      console.log('handleSaveResolveIssue: Attempting to log action. logAction available?', !!logAction);\n      if (logAction) {\n        await logAction({\n          orgId: org.id,\n          toolKey: 'incomingtool',\n          action: 'item.update.issue.resolve', // Standardized action name\n          entityPath: `stockItems/${itemId}`,\n          before: itemBefore,\n          after: { ...itemBefore, currentStatus: newStatus }, // Approximate state after update\n          details: { resolutionOutcome: outcome, note }\n        });\n      }\n      setResolvingIssueItem(null); // Close modal\n    } catch (err) {\n      setError('Failed to resolve issue: ' + (err as Error).message);\n    }\n  }, [resolvingIssueItem, org?.id, user?.uid, allItems, logAction, setResolvingIssueItem, setError]);\n\n  // Handler for Saving (Create or Update)\n  const handleCloseFormModal = useCallback(() => {\n    setIsAddItemModalOpen(false);\n    setEditingItem(null); // Clear editing state when closing\n  }, [setIsAddItemModalOpen, setEditingItem]);\n\n  const handleSaveItem = useCallback(async (itemData: Omit<StockItem, 'id' | 'currentStatus' | 'dateDelivered' | 'activityLog'> & { isFlagged: boolean }) => {\n    console.log('ToolApp: current editingItem at save', editingItem);\n    if (!org?.id || !db) {\n      console.error('ToolApp: Cannot save item because org.id or db is undefined', org);\n      setError('Cannot save item: No organization selected or database unavailable.');\n      return;\n    }\n    console.log('ToolApp: handleSaveItem called', itemData);\n    try {\n      if (editingItem && editingItem.id) {\n        // --- UPDATE LOGIC ---\n        const itemId = editingItem.id;\n        // Determine changed fields for the EDIT event\n        const changedFields = (Object.keys(itemData) as Array<keyof typeof itemData>).filter(key =>\n          editingItem.hasOwnProperty(key) && editingItem[key] !== itemData[key]\n        );\n        // Ensure isFlagged is always considered if it exists in itemData\n        if ('isFlagged' in itemData && !changedFields.includes('isFlagged') && editingItem.isFlagged !== itemData.isFlagged) {\n             changedFields.push('isFlagged');\n        }\n\n        const editEvent = createActivityEvent(user?.uid || '', 'EDITED', { changedFields: changedFields.length > 0 ? changedFields : undefined });\n\n        // Use updateItemAndLog for the actual update and central logging\n        await updateItemAndLog(itemId, user?.uid, itemData, editEvent);\n\n      } else {\n        // --- CREATE LOGIC ---\n        const createdEvent = createActivityEvent(user?.uid || '', 'CREATED');\n        const newItem = removeUndefinedFields({\n          ...itemData,\n          currentStatus: 'Pending Delivery',\n          activityLog: [createdEvent],\n          lastUpdated: serverTimestamp(),\n        });\n        const docRef = await addDoc(collection(db, 'orgs', org.id, 'stockItems'), newItem);\n\n        // Log create action separately (as updateItemAndLog needs an existing item)\n        console.log('handleSaveItem: Attempting to log action. logAction available?', !!logAction);\n        if (logAction) {\n          await logAction({\n            orgId: org.id,\n            toolKey: 'incomingtool',\n            action: 'item.create',\n            entityPath: `stockItems/${docRef.id}`,\n            after: newItem // Log the data that was added\n            // 'before' is omitted for create actions\n          });\n        }\n      }\n      handleCloseFormModal(); // Close modal on success\n    } catch (err) {\n      console.error('Failed to save item', err);\n      setError('Failed to save item: ' + (err as Error).message);\n      // Optionally, don't close the modal on error\n    }\n  }, [editingItem, org, user, logAction, updateItemAndLog, handleCloseFormModal, setError]);\n\n  // Handler to close the item details modal\n  const handleCloseDetailModal = useCallback(() => {\n    setSelectedItemDetails(null); // Clear state to hide the modal\n  }, [setSelectedItemDetails]);\n\n  // Ref to store the current org ID to avoid useCallback dependency issues\n  const orgIdRef = useRef<string | undefined>(undefined); // Initialize with undefined\n\n  // Effect to update the orgIdRef whenever the org prop changes\n  useEffect(() => {\n    orgIdRef.current = org?.id;\n  }, [org]);\n\n  // Handler to open the Add Item modal (clears any editing state)\n  const handleAddItem = useCallback(() => {\n    // Use the ref to get the current org ID\n    const currentOrgId = orgIdRef.current;\n    if (!currentOrgId) {\n      setError(\"Cannot add item: Organization ID is missing.\");\n      return;\n    }\n    // Clear any existing edit state and open add-item modal\n    setEditingItem(null);\n    setIsAddItemModalOpen(true);\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [setIsAddItemModalOpen, setEditingItem, setError]);\n\n  // *** RESTORED HANDLERS END ***\n\n  // Handler for column drag-and-drop reordering\n  const handleColumnDragEnd = (event: DragEndEvent) => {\n    const { active, over } = event;\n\n    if (over && active.id !== over.id) {\n      setVisibleColumnIds((currentIds) => {\n        const oldIndex = currentIds.indexOf(active.id as ColumnConfig['id']);\n        const newIndex = currentIds.indexOf(over.id as ColumnConfig['id']);\n        // Use arrayMove to update the order\n        return arrayMove(currentIds, oldIndex, newIndex);\n      });\n    }\n  };\n\n  // Handler for saving column visibility changes from modal\n  const handleSaveColumnSettings = (idsFromModal: Array<ColumnConfig['id']>) => {\n    setVisibleColumnIds(currentVisibleIds => {\n        const modalIdSet = new Set(idsFromModal);\n\n        // 1. Filter current IDs to keep only those still checked in the modal (preserves order)\n        const keptOrderedIds = currentVisibleIds.filter(id => modalIdSet.has(id));\n\n        // 2. Find IDs that are in the modal list but *not* in the current visible list (newly checked)\n        const newlyAddedIds = idsFromModal.filter(id => !currentVisibleIds.includes(id));\n\n        // 3. Combine the kept ordered IDs with the newly added ones\n        const newVisibleOrder = [...keptOrderedIds, ...newlyAddedIds];\n\n        // Ensure 'actions' column is always present if it was somehow removed (optional safeguard)\n        // if (!newVisibleOrder.includes('actions') && ALL_COLUMNS.some(c => c.id === 'actions')) {\n        //     newVisibleOrder.push('actions');\n        // }\n\n        return newVisibleOrder;\n    });\n    setIsSettingsModalOpen(false);\n  };\n\n  // Ref for search input\n  const searchInputRef = useRef<HTMLInputElement>(null);\n\n  // Handler for viewing item details from StockProcessingList\n  const handleViewDetails = (itemId: string) => {\n    const item = allItems.find(i => i.id === itemId);\n    if (item) setSelectedItemDetails(item);\n  };\n\n  // Effect hook for handling global keyboard shortcuts (Corrected structure with original logic)\n  useEffect(() => {\n    const handleKeyDown = (e: KeyboardEvent) => {\n      // console.log('Keydown event:', e.key); // Keep debug log if useful\n\n      // Don't trigger shortcuts if typing in an input or textarea\n      const target = e.target as HTMLElement;\n      const tag = target.tagName;\n      if (tag === 'INPUT' || tag === 'TEXTAREA' || target.isContentEditable) return;\n\n      // If any modal is open, only allow 'Escape' key\n      const anyModalOpen = isAddItemModalOpen || isSettingsModalOpen || selectedItemDetails || reportingIssueItem || addingUpdateItem || resolvingIssueItem || isHelpModalOpen;\n\n      if (anyModalOpen) {\n        if (e.key === 'Escape') {\n          // Close modals\n          if (isAddItemModalOpen) setIsAddItemModalOpen(false);\n          if (isSettingsModalOpen) setIsSettingsModalOpen(false);\n          if (selectedItemDetails) setSelectedItemDetails(null);\n          if (reportingIssueItem) setReportingIssueItem(null);\n          if (addingUpdateItem) setAddingUpdateItem(null);\n          if (resolvingIssueItem) setResolvingIssueItem(null);\n          if (isHelpModalOpen) setIsHelpModalOpen(false);\n        }\n        return; // Ignore other keys if a modal is open\n      }\n\n      // --- Filter tab shortcuts --- (Restored)\n      if (e.key >= '1' && e.key <= '6') {\n        const tabMap: (ItemStatus | 'All')[] = ['All', 'Pending Delivery', 'Delivered', 'Issue', 'Late', 'Archived'];\n        const index = parseInt(e.key, 10) - 1;\n        if (index >= 0 && index < tabMap.length) {\n          setCurrentFilter(tabMap[index]);\n          e.preventDefault();\n          return;\n        }\n      }\n\n      // --- Help overlay --- (Restored)\n      if (e.key === '?') {\n        setIsHelpModalOpen(true);\n        e.preventDefault();\n        return;\n      }\n\n      // --- Row navigation and actions --- (Restored)\n      if (filteredItems.length > 0) {\n        if (e.key === 'ArrowDown') {\n          setSelectedRowIndex(idx => Math.min(filteredItems.length - 1, idx < 0 ? 0 : idx + 1));\n          e.preventDefault();\n          return;\n        }\n        if (e.key === 'ArrowUp') {\n          setSelectedRowIndex(idx => Math.max(0, idx - 1));\n          e.preventDefault();\n          return;\n        }\n        // Use 'Enter' or 'o' to open details (Restored)\n        if (e.key === 'Enter' || e.key === 'o') {\n          if (selectedRowIndex >= 0 && selectedRowIndex < filteredItems.length) {\n            setSelectedItemDetails(filteredItems[selectedRowIndex]);\n            e.preventDefault();\n            return;\n          }\n        }\n        // Use 'e' to edit (Restored)\n        if (e.key === 'e') {\n           if (selectedRowIndex >= 0 && selectedRowIndex < filteredItems.length) {\n             const itemToEdit = filteredItems[selectedRowIndex];\n             setEditingItem(itemToEdit); // Set the item to be edited\n             setIsAddItemModalOpen(true); // Open the modal (assuming it handles edits)\n             e.preventDefault();\n             return;\n           }\n         }\n        // Use 'r' to report issue (Restored)\n        if (e.key === 'r') {\n          if (selectedRowIndex >= 0 && selectedRowIndex < filteredItems.length) {\n            setReportingIssueItem(filteredItems[selectedRowIndex]);\n            e.preventDefault();\n            return;\n          }\n        }\n        // Use 'l' to toggle flag (Restored)\n        if (e.key === 'l') {\n          if (selectedRowIndex >= 0 && selectedRowIndex < filteredItems.length) {\n            const item = filteredItems[selectedRowIndex];\n            handleItemAction(item.id, item.isFlagged ? 'Unflag Item' : 'Flag Item');\n            e.preventDefault();\n            return;\n          }\n        }\n      }\n\n      // --- Other general shortcuts --- (Restored)\n      switch (e.key) {\n        case '/':\n          e.preventDefault(); // Prevent typing '/' in the search bar itself\n          searchInputRef.current?.focus();\n          break;\n        case 'a':\n        case 'A':\n          // Prevent opening add modal if editing\n          if (!editingItem) {\n             handleAddItem();\n          }\n          break;\n        case 'c':\n        case 'C':\n          setIsSettingsModalOpen(true);\n          break;\n        // 'f'/'F' toggle flag filter handled separately now if needed\n        // case 'f':\n        // case 'F':\n        //   setShowFlaggedOnly(v => !v); // Or use handleItemAction if 'l' is preferred\n        //   break;\n        default:\n          break;\n      }\n    }; // End of handleKeyDown function definition\n\n    // Add event listener when component mounts\n    document.addEventListener('keydown', handleKeyDown);\n\n    // Cleanup function to remove event listener when component unmounts\n    return () => {\n      document.removeEventListener('keydown', handleKeyDown);\n    };\n\n  }, [\n    // Dependencies: include all state and props used inside the effect\n    isAddItemModalOpen, isSettingsModalOpen, selectedItemDetails,\n    reportingIssueItem, addingUpdateItem, resolvingIssueItem, isHelpModalOpen,\n    filteredItems, selectedRowIndex, editingItem, \n    // Include functions called from within the effect if they aren't stable (use useCallback)\n    handleItemAction, setCurrentFilter, handleAddItem\n  ]);\n\n  return (\n    <div style={{ padding: 24 }}> {/* Removed border from original template */}\n      <h2>Incoming Stock Tool</h2>\n      {error && <div style={{ color: 'red', marginBottom: '1rem' }}>Error: {error}</div>}\n      {loading && <div style={{ color: 'blue', marginBottom: '1rem' }}>Loading items...</div>}\n      \n      {/* Add Item Button */}\n      <AddItemButton onClick={handleAddItem} />\n\n      {/* Search and Filter Controls */}\n      <SearchBar onSearch={handleSearch} inputRef={searchInputRef} />\n      {/* Container for Filters and Flag Toggle */}\n       <div style={{ display: 'flex', alignItems: 'center', marginBottom: '1rem' }}>\n         <FilterTabs currentFilter={currentFilter} onFilterChange={handleFilterChange} />\n         <FlagToggle isChecked={showFlaggedOnly} onChange={setShowFlaggedOnly} /> \n         {/* Add Table Settings Button */}\n         <button \n            onClick={() => setIsSettingsModalOpen(true)} \n            style={{ marginLeft: 'auto', padding: '5px 10px' }} \n            title=\"Configure Table Columns\"\n         >\n              Columns\n         </button>\n       </div>\n      \n      {/* Stock List Display */}\n      <StockProcessingList \n        items={filteredItems} \n        visibleColumns={visibleColumns} // Pass derived visible columns\n        onActionSelected={handleItemAction} \n        onViewDetails={handleViewDetails}\n        onColumnReorder={handleColumnDragEnd} // Pass the drag handler\n        selectedRowIndex={selectedRowIndex}\n      />\n      \n      {/* Render Add/Edit Item Form Modal */}\n      {isAddItemModalOpen && (\n         <div style={{ \n            position: 'fixed', \n            top: 0, \n            left: 0, \n            right: 0, \n            bottom: 0, \n            backgroundColor: 'rgba(0,0,0,0.5)', \n            display: 'flex', \n            alignItems: 'center', \n            justifyContent: 'center', \n            zIndex: 20 \n          }}> {/* Basic overlay */}\n          <AddItemForm \n            onSave={handleSaveItem} // Use combined save handler\n            onClose={handleCloseFormModal} // Use combined close handler\n            initialData={editingItem} // Pass item to edit (null if adding)\n          />\n        </div>\n      )}\n\n      {/* Render Item Details Modal */}\n      {selectedItemDetails && (\n        <ItemDetailModal \n          item={selectedItemDetails} \n          onClose={handleCloseDetailModal} \n        />\n      )}\n\n      {/* New Modals for Issue Handling */}\n      {reportingIssueItem && (\n        <ReportIssueModal \n            item={reportingIssueItem} // Pass the item\n            onSubmit={handleSaveReportIssue} \n            onClose={() => setReportingIssueItem(null)} \n        />\n      )}\n      {addingUpdateItem && (\n        <AddUpdateModal \n            item={addingUpdateItem} // Pass the item context\n            onSubmit={handleSaveIssueUpdate} \n            onClose={() => setAddingUpdateItem(null)} \n        />\n      )}\n       {resolvingIssueItem && (\n        <ResolveIssueModal \n            item={resolvingIssueItem} // Pass the item\n            onSubmit={handleSaveResolveIssue} \n            onClose={() => setResolvingIssueItem(null)} \n        />\n      )}\n\n      {/* Render Table Settings Modal */}\n      <TableSettingsModal\n        isOpen={isSettingsModalOpen}\n        onClose={() => setIsSettingsModalOpen(false)}\n        allColumns={ALL_COLUMNS}\n        initialVisibleColumns={visibleColumns} // Pass current derived configs\n        onSave={handleSaveColumnSettings} // Handler updates visibleColumnIds state\n      />\n      {/* Render Help Modal */}\n      {isHelpModalOpen && <HelpModal onClose={() => setIsHelpModalOpen(false)} />}\n    </div>\n  );\n}\n\nexport default ToolApp;","import React, { useState } from 'react';\r\nimport { StockItem } from './types'; // Import StockItem if needed for context\r\n\r\ninterface ReportIssueModalProps {\r\n  item: StockItem; // Pass the item for context\r\n  onSubmit: (description: string) => void;\r\n  onClose: () => void;\r\n}\r\n\r\nconst ReportIssueModal: React.FC<ReportIssueModalProps> = ({ item, onSubmit, onClose }) => {\r\n  const [description, setDescription] = useState('');\r\n  const [error, setError] = useState('');\r\n\r\n  const handleSubmit = () => {\r\n    if (!description.trim()) {\r\n      setError('Please enter a description of the issue.');\r\n      return;\r\n    }\r\n    onSubmit(description);\r\n  };\r\n\r\n  // Basic modal styling (similar to others)\r\n  const overlayStyle: React.CSSProperties = {\r\n    position: 'fixed', top: 0, left: 0, right: 0, bottom: 0,\r\n    backgroundColor: 'rgba(0,0,0,0.5)', display: 'flex', \r\n    alignItems: 'center', justifyContent: 'center', zIndex: 50,\r\n  };\r\n  const modalStyle: React.CSSProperties = {\r\n    backgroundColor: 'white', padding: '20px 30px', borderRadius: '8px',\r\n    border: '1px solid #ccc', maxWidth: '500px', width: '90%',\r\n    boxShadow: '0 4px 8px rgba(0,0,0,0.1)',\r\n  };\r\n  const textareaStyle: React.CSSProperties = {\r\n      width: 'calc(100% - 16px)', padding: '8px', minHeight: '80px', marginTop: '5px'\r\n  };\r\n  const errorStyle: React.CSSProperties = { color: 'red', fontSize: '0.8em', marginTop: '4px' };\r\n\r\n  return (\r\n    <div style={overlayStyle} onClick={onClose}>\r\n      <div style={modalStyle} onClick={(e) => e.stopPropagation()}>\r\n        <h3>Report Issue for:</h3>\r\n        <p style={{margin: '5px 0 15px 0', fontStyle: 'italic'}}>{item.productName} - {item.deliveryName}</p>\r\n        \r\n        <label htmlFor=\"issueDescription\" style={{ fontWeight: 'bold' }}>\r\n            Describe the Issue:\r\n        </label>\r\n        <textarea \r\n            id=\"issueDescription\"\r\n            value={description}\r\n            onChange={(e) => {\r\n                setDescription(e.target.value);\r\n                if (error) setError(''); // Clear error on type\r\n            }}\r\n            style={textareaStyle}\r\n            rows={4}\r\n        />\r\n        {error && <div style={errorStyle}>{error}</div> }\r\n\r\n        <div style={{ marginTop: '20px', textAlign: 'right' }}>\r\n          <button type=\"button\" onClick={onClose} style={{ marginRight: '10px', padding: '8px 15px' }}>\r\n            Cancel\r\n          </button>\r\n          <button type=\"button\" onClick={handleSubmit} style={{ padding: '8px 15px', fontWeight: 'bold' }}>\r\n            Save Issue Report\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ReportIssueModal; ","import React, { useState, useEffect } from 'react';\r\nimport { ColumnConfig } from './ToolApp'; // Import ColumnConfig from ToolApp\r\n\r\ninterface TableSettingsModalProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  allColumns: ColumnConfig[];\r\n  initialVisibleColumns: ColumnConfig[];\r\n  onSave: (newVisibleColumnIds: Array<ColumnConfig['id']>) => void;\r\n}\r\n\r\n// --- Main Modal Component ---\r\nconst TableSettingsModal: React.FC<TableSettingsModalProps> = ({\r\n  isOpen,\r\n  onClose,\r\n  allColumns,\r\n  initialVisibleColumns,\r\n  onSave\r\n}) => {\r\n  // State to track checked status of each column ID\r\n  const [checkedState, setCheckedState] = useState<Record<ColumnConfig['id'], boolean>>(() =>\r\n    // Initialize state using Object.fromEntries for correct typing\r\n    Object.fromEntries(\r\n        allColumns.map(col => [col.id, false])\r\n    ) as Record<ColumnConfig['id'], boolean>\r\n  );\r\n\r\n  // Initialize or update checked state when modal opens or initialVisibleColumns change\r\n  useEffect(() => {\r\n    if (isOpen) {\r\n        const visibleIds = new Set(initialVisibleColumns.map(col => col.id));\r\n        // Create the updated state object directly using Object.fromEntries\r\n        const updatedCheckedState = Object.fromEntries(\r\n            allColumns.map(col => [col.id, visibleIds.has(col.id)])\r\n        ) as Record<ColumnConfig['id'], boolean>;\r\n        setCheckedState(updatedCheckedState);\r\n    }\r\n  }, [isOpen, initialVisibleColumns, allColumns]);\r\n\r\n  const handleCheckboxChange = (columnId: ColumnConfig['id']) => {\r\n      setCheckedState(prevState => ({\r\n          ...prevState,\r\n          [columnId]: !prevState[columnId]\r\n      }));\r\n  };\r\n\r\n  const handleSaveChanges = () => {\r\n    // Filter all column IDs to get only the ones that are checked\r\n    const newVisibleColumnIds = allColumns\r\n        .map(col => col.id)\r\n        .filter(id => checkedState[id]);\r\n    onSave(newVisibleColumnIds); // Pass the array of visible IDs\r\n  };\r\n\r\n  if (!isOpen) return null;\r\n\r\n  // Basic modal styling\r\n  const overlayStyle: React.CSSProperties = {\r\n    position: 'fixed', top: 0, left: 0, right: 0, bottom: 0,\r\n    backgroundColor: 'rgba(0,0,0,0.5)', display: 'flex',\r\n    alignItems: 'center', justifyContent: 'center', zIndex: 60\r\n  };\r\n  const modalStyle: React.CSSProperties = {\r\n    backgroundColor: 'white', padding: '20px 30px', borderRadius: '8px',\r\n    border: '1px solid #ccc', width: '400px', // Adjusted width\r\n    maxWidth: '90%', maxHeight: '80vh', display: 'flex', flexDirection: 'column',\r\n    boxShadow: '0 4px 8px rgba(0,0,0,0.1)',\r\n  };\r\n  const listContainerStyle: React.CSSProperties = {\r\n    flexGrow: 1, overflowY: 'auto', // Make the list scrollable\r\n    padding: '10px 0', border: '1px solid #eee', borderRadius: '4px',\r\n    marginBottom: '15px'\r\n  };\r\n  const checkboxItemStyle: React.CSSProperties = {\r\n      padding: '8px 12px',\r\n      display: 'flex',\r\n      alignItems: 'center'\r\n  };\r\n  const checkboxLabelStyle: React.CSSProperties = {\r\n      marginLeft: '10px',\r\n      cursor: 'pointer'\r\n  };\r\n\r\n  return (\r\n    <div style={overlayStyle} onClick={onClose} >\r\n      <div style={modalStyle} onClick={(e) => e.stopPropagation()} >\r\n        <h3>Configure Table Columns</h3>\r\n        <p>Select the columns you want to display:</p>\r\n\r\n        {/* Single list for all columns with checkboxes */}\r\n        <div style={listContainerStyle} >\r\n           {allColumns.map(col => (\r\n              <div key={col.id} style={checkboxItemStyle}>\r\n                  <input\r\n                      type=\"checkbox\"\r\n                      id={`col-checkbox-${col.id}`}\r\n                      checked={checkedState[col.id] || false}\r\n                      onChange={() => handleCheckboxChange(col.id)}\r\n                      disabled={col.id === 'actions'} // Optionally disable toggling for essential columns like 'actions'\r\n                  />\r\n                  <label htmlFor={`col-checkbox-${col.id}`} style={checkboxLabelStyle}>\r\n                      {col.label}\r\n                  </label>\r\n              </div>\r\n           ))}\r\n        </div>\r\n\r\n        <div style={{ marginTop: 'auto', textAlign: 'right', borderTop: '1px solid #eee', paddingTop: '15px' }} >\r\n          <button type=\"button\" onClick={onClose} style={{ marginRight: '10px', padding: '8px 15px' }} >\r\n            Cancel\r\n          </button>\r\n          <button type=\"button\" onClick={handleSaveChanges} style={{ padding: '8px 15px', fontWeight: 'bold' }} >\r\n            Save Column Settings\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default TableSettingsModal; "],"names":["_ref","item","onSubmit","onClose","note","setNote","useState","error","setError","_jsx","style","position","top","left","right","bottom","backgroundColor","display","alignItems","justifyContent","zIndex","onClick","children","_jsxs","padding","borderRadius","border","maxWidth","width","boxShadow","e","stopPropagation","margin","fontStyle","productName","deliveryName","issueDescription","marginBottom","background","htmlFor","fontWeight","id","value","onChange","target","minHeight","marginTop","rows","placeholder","color","fontSize","textAlign","type","marginRight","handleSubmit","trim","RESOLUTION_OUTCOMES","outcome","setOutcome","inputGroupStyle","labelStyle","inputStyle","disabled","map","opt","undefined","InfoIcon","text","title","cursor","marginLeft","borderBottom","_ref2","onSave","initialData","firstInputRef","isEditing","purchaseStatus","setPurchaseStatus","setDeliveryName","setProductName","quantity","setQuantity","pricePerItem","setPricePerItem","orderNumber","setOrderNumber","orderDate","setOrderDate","Date","toISOString","split","seller","setSeller","isVatRegistered","setIsVatRegistered","destination","setDestination","asinSku","setAsinSku","acquisitionNotes","setAcquisitionNotes","isFlagged","setIsFlagged","errors","setErrors","useEffect","errorStyle","event","preventDefault","console","log","isValid","validateForm","newErrors","Object","keys","length","Number","ref","min","step","includes","height","checked","formatValue","prefix","arguments","suffix","formatActivityEvent","_event$details$change","time","timestamp","toLocaleString","details","changedFields","join","previousStatus","newStatus","resolutionOutcome","closeButtonRef","detailRowStyle","paddingBottom","minWidth","historyItemStyle","maxHeight","overflowY","currentStatus","dateDelivered","processorNotes","activityLog","paddingTop","borderTop","reverse","index","removeUndefinedFields","obj","fromEntries","entries","filter","_","v","SearchBar","onSearch","inputRef","FilterTabs","_ref3","currentFilter","onFilterChange","isItemLate","sevenDaysAgo","setDate","getDate","getStatusStyle","status","isLate","flaggedStyle","borderLeft","baseStyle","createActivityEvent","userId","getAvailableActions","actions","unshift","ActionMenu","_ref4","itemId","onActionSelected","menuRef","useRef","handleClickOutside","current","contains","document","addEventListener","removeEventListener","action","onMouseEnter","currentTarget","onMouseLeave","ALL_COLUMNS","label","DEFAULT_VISIBLE_COLUMN_IDS","LOCAL_STORAGE_KEY_VISIBLE_COLUMNS","DraggableHeader","_ref5","col","attributes","listeners","setNodeRef","transform","transition","isDragging","useSortable","CSS","Translate","toString","opacity","StockProcessingList","_ref6","items","visibleColumns","onViewDetails","onColumnReorder","selectedRowIndex","openMenuId","setOpenMenuId","sensors","useSensors","useSensor","PointerSensor","KeyboardSensor","coordinateGetter","sortableKeyboardCoordinates","handleCloseMenu","handleAction","renderCellContent","columnId","renderPrimitive","prevId","numValue","dateValue","formattedDate","toLocaleDateString","noteValue","warn","DndContext","collisionDetection","closestCenter","onDragEnd","SortableContext","strategy","horizontalListSortingStrategy","borderCollapse","idx","isSelected","outline","colSpan","AddItemButton","_ref7","FlagToggle","_ref8","isChecked","HelpModal","_ref9","lineHeight","autoFocus","firebaseConfig","apiKey","process","authDomain","projectId","storageBucket","messagingSenderId","appId","forEach","_ref10","key","Error","app","initializeApp","db","getAuth","getFirestore","_ref11","user","org","permissions","logAction","orgId","logActionExists","setSelectedRowIndex","isHelpModalOpen","setIsHelpModalOpen","allItems","setAllItems","loading","setLoading","searchTerm","setSearchTerm","setCurrentFilter","selectedItemDetails","setSelectedItemDetails","isAddItemModalOpen","setIsAddItemModalOpen","showFlaggedOnly","setShowFlaggedOnly","editingItem","setEditingItem","reportingIssueItem","setReportingIssueItem","addingUpdateItem","setAddingUpdateItem","resolvingIssueItem","setResolvingIssueItem","isSettingsModalOpen","setIsSettingsModalOpen","visibleColumnIds","setVisibleColumnIds","stored","localStorage","getItem","parsed","JSON","parse","Array","isArray","setItem","stringify","find","filteredItems","matchesSearch","toLowerCase","matchesFilter","matchesFlag","q","query","collection","orderBy","unsub","onSnapshot","snapshot","docs","docSnap","data","err","message","updateItemAndLog","useCallback","async","changes","itemRef","doc","itemBefore","i","finalUpdates","lastUpdated","serverTimestamp","itemAfter","updateDoc","actionName","_event$details","_event$details$newSta","nameError","logData","toolKey","entityPath","before","after","handleItemAction","newFlagState","uid","handleSaveReportIssue","reportEvent","description","_allItems$find","handleSaveIssueUpdate","handleSaveResolveIssue","resolveEvent","_allItems$find2","handleCloseFormModal","handleSaveItem","itemData","hasOwnProperty","push","editEvent","createdEvent","newItem","docRef","addDoc","handleCloseDetailModal","orgIdRef","handleAddItem","searchInputRef","handleKeyDown","_searchInputRef$curre","tag","tagName","isContentEditable","tabMap","parseInt","Math","max","itemToEdit","focus","term","active","over","currentIds","oldIndex","indexOf","newIndex","arrayMove","AddItemForm","ItemDetailModal","ReportIssueModal","AddUpdateModal","ResolveIssueModal","TableSettingsModal","isOpen","allColumns","initialVisibleColumns","idsFromModal","currentVisibleIds","modalIdSet","Set","has","setDescription","checkedState","setCheckedState","visibleIds","updatedCheckedState","checkboxItemStyle","checkboxLabelStyle","flexDirection","flexGrow","handleCheckboxChange","prevState","handleSaveChanges","newVisibleColumnIds"],"sourceRoot":""}